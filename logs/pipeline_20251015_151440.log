2025-10-15 15:14:40,072 - INFO - 
    ╔═══════════════════════════════════════════════════════════════╗
    ║                                                               ║
    ║       CLOUDERA DATA ENGINEERING PIPELINE                      ║
    ║       Análisis de Transacciones Bancarias                     ║
    ║                                                               ║
    ╚═══════════════════════════════════════════════════════════════╝
    
2025-10-15 15:14:40,072 - INFO - Inicio del pipeline: 2025-10-15 15:14:40
2025-10-15 15:14:40,072 - INFO - Scripts a ejecutar: 6
2025-10-15 15:14:40,072 - INFO - 
2025-10-15 15:14:40,072 - INFO - 
################################################################################
2025-10-15 15:14:40,072 - INFO - FASE 1/6: 01_ingest_data.py
2025-10-15 15:14:40,072 - INFO - ################################################################################

2025-10-15 15:14:40,072 - INFO - ================================================================================
2025-10-15 15:14:40,072 - INFO - EJECUTANDO: 01_ingest_data.py
2025-10-15 15:14:40,072 - INFO - ================================================================================
2025-10-15 15:14:46,442 - INFO - ✅ Constantes cargadas. Base dir: /home/jhon/Escritorio/proyectos/mini-proyecto-cloudera
+--------------+-----------+------------+-------+-------+--------+---------------+----------+-------------------+--------+-----------+----------+
|transaction_id|customer_id|account_type|country|amount |currency|category       |channel   |timestamp          |status  |merchant_id|card_last4|
+--------------+-----------+------------+-------+-------+--------+---------------+----------+-------------------+--------+-----------+----------+
|2689          |202        |Premium     |ES     |150.53 |EUR     |Farmacia       |Online    |2025-10-01 00:24:33|APPROVED|M27405     |5770      |
|2330          |683        |Empresarial |FR     |1962.76|EUR     |Transferencia  |Presencial|2025-10-01 00:31:29|DECLINED|M53003     |1131      |
|2833          |486        |Ahorro      |ES     |50.12  |EUR     |E-commerce     |Presencial|2025-10-01 01:45:23|APPROVED|M98403     |7223      |
|2929          |436        |Corriente   |FR     |94.47  |EUR     |Entretenimiento|Movil     |2025-10-01 04:37:51|APPROVED|M37822     |5501      |
|2519          |575        |Ahorro      |ES     |70.28  |EUR     |E-commerce     |Online    |2025-10-01 05:08:35|DECLINED|M33039     |4285      |
+--------------+-----------+------------+-------+-------+--------+---------------+----------+-------------------+--------+-----------+----------+
only showing top 5 rows


2025-10-15 15:14:46,442 - INFO - ✅ 01_ingest_data.py completado en 6.37 segundos
2025-10-15 15:14:46,442 - INFO - 
────────────────────────────────────────────────────────────────────────────────

2025-10-15 15:14:46,442 - INFO - 
################################################################################
2025-10-15 15:14:46,442 - INFO - FASE 2/6: 02_transform_data.py
2025-10-15 15:14:46,442 - INFO - ################################################################################

2025-10-15 15:14:46,442 - INFO - ================================================================================
2025-10-15 15:14:46,442 - INFO - EJECUTANDO: 02_transform_data.py
2025-10-15 15:14:46,442 - INFO - ================================================================================
2025-10-15 15:14:51,793 - INFO - ✅ Constantes cargadas. Base dir: /home/jhon/Escritorio/proyectos/mini-proyecto-cloudera
+--------------+-----------+------+-------------------+---------+---------------+--------------------+----------+
|transaction_id|customer_id|amount|timestamp          |time_slot|amount_category|transaction_velocity|risk_score|
+--------------+-----------+------+-------------------+---------+---------------+--------------------+----------+
|1853          |100        |48.45 |2025-10-02 08:54:13|Mañana   |Bajo           |Primera Transacción |0         |
|2307          |100        |144.76|2025-10-07 09:45:57|Mañana   |Medio          |Lenta               |0         |
|2076          |100        |414.36|2025-10-08 17:14:29|Tarde    |Alto           |Lenta               |2         |
|2852          |100        |178.71|2025-10-10 13:08:20|Tarde    |Medio          |Lenta               |0         |
|2939          |101        |202.78|2025-10-03 19:57:45|Noche    |Alto           |Primera Transacción |0         |
+--------------+-----------+------+-------------------+---------+---------------+--------------------+----------+
only showing top 5 rows


2025-10-15 15:14:51,794 - INFO - ✅ 02_transform_data.py completado en 5.35 segundos
2025-10-15 15:14:51,794 - INFO - 
────────────────────────────────────────────────────────────────────────────────

2025-10-15 15:14:51,794 - INFO - 
################################################################################
2025-10-15 15:14:51,794 - INFO - FASE 3/6: 03_fraud_detection.py
2025-10-15 15:14:51,794 - INFO - ################################################################################

2025-10-15 15:14:51,794 - INFO - ================================================================================
2025-10-15 15:14:51,794 - INFO - EJECUTANDO: 03_fraud_detection.py
2025-10-15 15:14:51,794 - INFO - ================================================================================
2025-10-15 15:14:58,097 - INFO - ✅ Constantes cargadas. Base dir: /home/jhon/Escritorio/proyectos/mini-proyecto-cloudera
+--------------+-----+
|alert_priority|count|
+--------------+-----+
|       CRÍTICA|   18|
|          BAJA|   17|
|         MEDIA|    2|
+--------------+-----+

+-------+-----+
|country|count|
+-------+-----+
|     FR|   11|
|     ES|    7|
|     US|    6|
|     UK|    5|
|     DE|    4|
+-------+-----+

+--------------+-----------+-------+-------+-------------------+--------+--------------+----------+
|transaction_id|customer_id|amount |country|timestamp          |status  |alert_priority|risk_score|
+--------------+-----------+-------+-------+-------------------+--------+--------------+----------+
|2330          |683        |1962.76|FR     |2025-10-01 00:31:29|DECLINED|MEDIA         |5         |
|2555          |339        |1390.24|UK     |2025-10-05 00:50:01|DECLINED|MEDIA         |5         |
|2994          |274        |5054.82|US     |2025-10-12 19:50:41|DECLINED|BAJA          |4         |
|1704          |226        |4131.42|FR     |2025-10-07 11:39:58|DECLINED|BAJA          |4         |
|2231          |319        |3909.77|DE     |2025-10-12 14:52:01|DECLINED|BAJA          |4         |
|2171          |294        |3913.94|FR     |2025-10-13 07:53:12|DECLINED|BAJA          |4         |
|1067          |432        |3988.53|ES     |2025-10-04 13:36:43|DECLINED|BAJA          |4         |
|2202          |343        |3523.49|FR     |2025-10-10 09:54:09|DECLINED|BAJA          |4         |
|2336          |108        |4463.4 |ES     |2025-10-03 06:29:29|DECLINED|BAJA          |4         |
|2643          |180        |3143.38|US     |2025-10-08 09:45:51|DECLINED|BAJA          |4         |
+--------------+-----------+-------+-------+-------------------+--------+--------------+----------+
only showing top 10 rows


2025-10-15 15:14:58,097 - INFO - ✅ 03_fraud_detection.py completado en 6.30 segundos
2025-10-15 15:14:58,097 - INFO - 
────────────────────────────────────────────────────────────────────────────────

2025-10-15 15:14:58,097 - INFO - 
################################################################################
2025-10-15 15:14:58,097 - INFO - FASE 4/6: 04_create_hive_tables.py
2025-10-15 15:14:58,097 - INFO - ################################################################################

2025-10-15 15:14:58,097 - INFO - ================================================================================
2025-10-15 15:14:58,097 - INFO - EJECUTANDO: 04_create_hive_tables.py
2025-10-15 15:14:58,097 - INFO - ================================================================================
2025-10-15 15:15:02,961 - INFO - ✅ Constantes cargadas. Base dir: /home/jhon/Escritorio/proyectos/mini-proyecto-cloudera
+------------------------------+---------+-------+
|col_name                      |data_type|comment|
+------------------------------+---------+-------+
|transaction_id                |int      |NULL   |
|customer_id                   |int      |NULL   |
|account_type                  |string   |NULL   |
|country                       |string   |NULL   |
|amount                        |double   |NULL   |
|currency                      |string   |NULL   |
|category                      |string   |NULL   |
|channel                       |string   |NULL   |
|timestamp                     |string   |NULL   |
|status                        |string   |NULL   |
|merchant_id                   |string   |NULL   |
|card_last4                    |string   |NULL   |
|timestamp_dt                  |timestamp|NULL   |
|hour                          |int      |NULL   |
|day_of_week                   |int      |NULL   |
|time_slot                     |string   |NULL   |
|is_weekend                    |boolean  |NULL   |
|amount_category               |string   |NULL   |
|minutes_since_last_transaction|double   |NULL   |
|customer_transaction_count    |bigint   |NULL   |
|transaction_velocity          |string   |NULL   |
|is_suspicious_night           |boolean  |NULL   |
|is_suspicious_velocity        |boolean  |NULL   |
|risk_score                    |int      |NULL   |
|year                          |int      |NULL   |
|month                         |int      |NULL   |
|day                           |int      |NULL   |
+------------------------------+---------+-------+


2025-10-15 15:15:02,962 - INFO - ✅ 04_create_hive_tables.py completado en 4.86 segundos
2025-10-15 15:15:02,962 - INFO - 
────────────────────────────────────────────────────────────────────────────────

2025-10-15 15:15:02,962 - INFO - 
################################################################################
2025-10-15 15:15:02,962 - INFO - FASE 5/6: 05_analytical_queries.py
2025-10-15 15:15:02,962 - INFO - ################################################################################

2025-10-15 15:15:02,962 - INFO - ================================================================================
2025-10-15 15:15:02,962 - INFO - EJECUTANDO: 05_analytical_queries.py
2025-10-15 15:15:02,962 - INFO - ================================================================================
2025-10-15 15:15:10,256 - INFO - ✅ Constantes cargadas. Base dir: /home/jhon/Escritorio/proyectos/mini-proyecto-cloudera
+------------------+----------------+------------+----------+----------+----------+--------+--------+-------------+
|total_transactions|unique_customers|total_amount|avg_amount|min_amount|max_amount|approved|declined|approval_rate|
+------------------+----------------+------------+----------+----------+----------+--------+--------+-------------+
|2000              |580             |605402.99   |302.7     |4.2       |5739.74   |1637    |302     |81.85        |
+------------------+----------------+------------+----------+----------+----------+--------+--------+-------------+

+-------+------------------+------------+----------+----------------+-------------+
|country|total_transactions|total_amount|avg_amount|unique_customers|approval_rate|
+-------+------------------+------------+----------+----------------+-------------+
|ES     |595               |190335.28   |319.89    |375             |81.51        |
|FR     |391               |116862.46   |298.88    |292             |80.05        |
|UK     |319               |92969.13    |291.44    |250             |84.95        |
|DE     |320               |88978.77    |278.06    |259             |81.88        |
|US     |194               |65466.04    |337.45    |163             |79.90        |
|MX     |181               |50791.31    |280.61    |153             |83.43        |
+-------+------------------+------------+----------+----------------+-------------+

+--------+------------------+------------+----------+
|currency|total_transactions|total_amount|avg_amount|
+--------+------------------+------------+----------+
|EUR     |1306              |396176.51   |303.35    |
|GBP     |319               |92969.13    |291.44    |
|USD     |194               |65466.04    |337.45    |
|MXN     |181               |50791.31    |280.61    |
+--------+------------------+------------+----------+

+---------------+------------------+------------+----------+----------+
|category       |total_transactions|total_amount|avg_amount|percentage|
+---------------+------------------+------------+----------+----------+
|Cajero         |217               |73764.3     |339.93    |10.85     |
|Supermercado   |210               |24770.87    |117.96    |10.50     |
|Hotel          |207               |85495.78    |413.02    |10.35     |
|Restaurante    |205               |31924.38    |155.73    |10.25     |
|E-commerce     |202               |41655.98    |206.22    |10.10     |
|Entretenimiento|199               |22876.28    |114.96    |9.95      |
|Transporte     |198               |14839.99    |74.95     |9.90      |
|Gasolinera     |193               |18898.26    |97.92     |9.65      |
|Farmacia       |185               |14521.42    |78.49     |9.25      |
|Transferencia  |184               |276655.73   |1503.56   |9.20      |
+---------------+------------------+------------+----------+----------+

+---------+------------------+------------+----------+--------------+
|time_slot|total_transactions|total_amount|avg_amount|declined_count|
+---------+------------------+------------+----------+--------------+
|Madrugada|148               |34437.01    |232.68    |19            |
|Mañana   |710               |225415.71   |317.49    |112           |
|Tarde    |763               |227279.29   |297.88    |116           |
|Noche    |379               |118270.98   |312.06    |55            |
+---------+------------------+------------+----------+--------------+

+-----------+------------------+-----------+---------------+------------+--------------+
|customer_id|total_transactions|total_spent|avg_transaction|account_type|declined_count|
+-----------+------------------+-----------+---------------+------------+--------------+
|108        |5                 |9010.94    |1802.19        |Empresarial |1             |
|426        |5                 |6850.37    |1370.07        |Empresarial |1             |
|157        |3                 |6420.64    |2140.21        |Empresarial |1             |
|517        |4                 |6334.78    |1583.7         |Premium     |1             |
|626        |3                 |6177.05    |2059.02        |Premium     |0             |
|309        |4                 |5933.46    |1483.37        |Premium     |2             |
|243        |4                 |5869.01    |1467.25        |Empresarial |0             |
|422        |6                 |5695.93    |949.32         |Premium     |3             |
|274        |3                 |5548.2     |1849.4         |Premium     |1             |
|233        |4                 |5300.72    |1325.18        |Empresarial |0             |
|690        |4                 |5104.74    |1276.19        |Empresarial |1             |
|589        |4                 |5103.15    |1275.79        |Premium     |0             |
|407        |4                 |5094.1     |1273.53        |Premium     |2             |
|384        |3                 |5055.6     |1685.2         |Empresarial |0             |
|109        |3                 |4948.28    |1649.43        |Empresarial |0             |
|640        |4                 |4855.56    |1213.89        |Premium     |2             |
|226        |4                 |4741.53    |1185.38        |Premium     |1             |
|150        |6                 |4697.8     |782.97         |Empresarial |0             |
|432        |3                 |4668.98    |1556.33        |Empresarial |2             |
|319        |8                 |4617.86    |577.23         |Empresarial |2             |
+-----------+------------------+-----------+---------------+------------+--------------+

+----+------------------+---------------+--------------+
|hour|total_transactions|high_risk_count|high_risk_rate|
+----+------------------+---------------+--------------+
|0   |25                |0              |0.00          |
|1   |13                |0              |0.00          |
|2   |19                |0              |0.00          |
|3   |13                |0              |0.00          |
|4   |27                |0              |0.00          |
|5   |38                |0              |0.00          |
|6   |67                |0              |0.00          |
|7   |91                |0              |0.00          |
|8   |127               |0              |0.00          |
|9   |174               |0              |0.00          |
|10  |131               |0              |0.00          |
|11  |120               |0              |0.00          |
|12  |152               |0              |0.00          |
|13  |144               |0              |0.00          |
|14  |147               |0              |0.00          |
|15  |96                |0              |0.00          |
|16  |100               |0              |0.00          |
|17  |124               |0              |0.00          |
|18  |141               |0              |0.00          |
|19  |102               |0              |0.00          |
+----+------------------+---------------+--------------+
only showing top 20 rows

+-------------+------------------+------------+----------+----------------+
|period_type  |total_transactions|total_amount|avg_amount|unique_customers|
+-------------+------------------+------------+----------+----------------+
|Entre Semana |1433              |419067.41   |292.44    |542             |
|Fin de Semana|567               |186335.58   |328.63    |366             |
+-------------+------------------+------------+----------+----------------+

+----------+------------------+------------+----------+-------------+
|channel   |total_transactions|total_amount|avg_amount|approval_rate|
+----------+------------------+------------+----------+-------------+
|Online    |915               |268635.26   |293.59    |81.75        |
|Movil     |597               |174954.78   |293.06    |81.91        |
|Presencial|389               |123259.82   |316.86    |82.01        |
|ATM       |99                |38553.13    |389.43    |81.82        |
+----------+------------------+------------+----------+-------------+

+--------------+-----------+-------+-------+--------+-------------+-------------------+----------+
|transaction_id|customer_id|country|amount |currency|category     |timestamp          |risk_score|
+--------------+-----------+-------+-------+--------+-------------+-------------------+----------+
|2994          |274        |US     |5054.82|USD     |Transferencia|2025-10-12 19:50:41|4         |
|1215          |422        |FR     |4712.63|EUR     |Transferencia|2025-10-05 09:12:08|4         |
|2336          |108        |ES     |4463.4 |EUR     |Transferencia|2025-10-03 06:29:29|4         |
|2161          |640        |UK     |4459.45|GBP     |Transferencia|2025-10-08 19:58:35|4         |
|2149          |309        |ES     |4296.94|EUR     |Transferencia|2025-10-09 09:20:56|4         |
|1704          |226        |FR     |4131.42|EUR     |Transferencia|2025-10-07 11:39:58|4         |
|1392          |157        |ES     |4022.73|EUR     |Transferencia|2025-10-01 09:43:21|4         |
|1067          |432        |ES     |3988.53|EUR     |Transferencia|2025-10-04 13:36:43|4         |
|2171          |294        |FR     |3913.94|EUR     |Transferencia|2025-10-13 07:53:12|4         |
|2231          |319        |DE     |3909.77|EUR     |Transferencia|2025-10-12 14:52:01|4         |
|2202          |343        |FR     |3523.49|EUR     |Transferencia|2025-10-10 09:54:09|4         |
|2643          |180        |US     |3143.38|USD     |Transferencia|2025-10-08 09:45:51|4         |
|2495          |524        |ES     |2391.13|EUR     |Transferencia|2025-10-09 14:00:21|4         |
|2050          |287        |US     |2363.01|USD     |Transferencia|2025-10-08 16:59:36|4         |
|2730          |490        |DE     |2263.52|EUR     |Transferencia|2025-10-03 14:31:43|4         |
|2936          |407        |US     |2043.8 |USD     |Transferencia|2025-10-14 15:15:34|4         |
|1577          |318        |UK     |1980.26|GBP     |Transferencia|2025-10-07 08:11:52|2         |
|2330          |683        |FR     |1962.76|EUR     |Transferencia|2025-10-01 00:31:29|5         |
|2678          |514        |DE     |1912.64|EUR     |Transferencia|2025-10-13 18:25:56|2         |
|2881          |595        |DE     |1875.45|EUR     |Transferencia|2025-10-03 15:07:43|2         |
+--------------+-----------+-------+-------+--------+-------------+-------------------+----------+


2025-10-15 15:15:10,256 - INFO - ✅ 05_analytical_queries.py completado en 7.29 segundos
2025-10-15 15:15:10,256 - INFO - 
────────────────────────────────────────────────────────────────────────────────

2025-10-15 15:15:10,256 - INFO - 
################################################################################
2025-10-15 15:15:10,256 - INFO - FASE 6/6: 06_generate_reports.py
2025-10-15 15:15:10,256 - INFO - ################################################################################

2025-10-15 15:15:10,257 - INFO - ================================================================================
2025-10-15 15:15:10,257 - INFO - EJECUTANDO: 06_generate_reports.py
2025-10-15 15:15:10,257 - INFO - ================================================================================
2025-10-15 15:15:15,070 - INFO - ✅ Constantes cargadas. Base dir: /home/jhon/Escritorio/proyectos/mini-proyecto-cloudera

2025-10-15 15:15:15,070 - INFO - ✅ 06_generate_reports.py completado en 4.81 segundos
2025-10-15 15:15:15,070 - INFO - 
────────────────────────────────────────────────────────────────────────────────

2025-10-15 15:15:15,070 - INFO - 
================================================================================
2025-10-15 15:15:15,070 - INFO - RESUMEN DEL PIPELINE
2025-10-15 15:15:15,070 - INFO - ================================================================================
2025-10-15 15:15:15,070 - INFO - 
Ejecutados: 6/6
2025-10-15 15:15:15,070 - INFO - Exitosos: 6
2025-10-15 15:15:15,070 - INFO - Fallidos: 0
2025-10-15 15:15:15,070 - INFO - 
Tiempo total: 35.00 segundos (0.58 minutos)
2025-10-15 15:15:15,070 - INFO - 
Detalle por script:
2025-10-15 15:15:15,070 - INFO -   ✅ OK | 01_ingest_data.py              | 6.37s
2025-10-15 15:15:15,070 - INFO -   ✅ OK | 02_transform_data.py           | 5.35s
2025-10-15 15:15:15,070 - INFO -   ✅ OK | 03_fraud_detection.py          | 6.30s
2025-10-15 15:15:15,070 - INFO -   ✅ OK | 04_create_hive_tables.py       | 4.86s
2025-10-15 15:15:15,070 - INFO -   ✅ OK | 05_analytical_queries.py       | 7.29s
2025-10-15 15:15:15,070 - INFO -   ✅ OK | 06_generate_reports.py         | 4.81s
2025-10-15 15:15:15,070 - INFO - 
================================================================================
2025-10-15 15:15:15,070 - INFO - 🎉 PIPELINE COMPLETADO EXITOSAMENTE
2025-10-15 15:15:15,070 - INFO - ================================================================================
2025-10-15 15:15:15,071 - INFO - 
📊 Revisa los reportes en: data/results/reports/
2025-10-15 15:15:15,071 - INFO - 📝 Log completo: /home/jhon/Escritorio/proyectos/mini-proyecto-cloudera/logs/pipeline_20251015_151440.log
